# NATS Server Configuration for User Permissions POC
listen: 0.0.0.0:4222

# Enable monitoring endpoint for debugging
http: 0.0.0.0:8222

# Authorization block with users and permissions
authorization {
  # Default permissions (if no user matches)
  default_permissions: {
    publish: {
      deny: [">"]
    }
    subscribe: {
      deny: [">"]
    }
  }
  
  # User definitions
  users: [
    # Foo user - has access to both narrow and broad subjects
    {
      user: "foo_user"
      password: "foo_pass"
      permissions: {
        publish: {
          allow: ["rpc.hello.world", "_INBOX.>", "broad.rpc.>"]
        }
        subscribe: {
          allow: ["rpc.hello.world", "_INBOX.>", "broad.rpc.>"]
        }
      }
    }
    
    # Bar user - only has access to broad subjects
    {
      user: "bar_user"
      password: "bar_pass"
      permissions: {
        publish: {
          allow: ["_INBOX.>", "broad.rpc.>"]
        }
        subscribe: {
          allow: ["_INBOX.>", "broad.rpc.>"]
        }
      }
    }
  ]
}

# Logging configuration for debugging
log_file: "./nats-server.log"
debug: true
trace: true
logtime: true
